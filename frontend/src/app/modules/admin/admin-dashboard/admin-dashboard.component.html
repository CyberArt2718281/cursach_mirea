<div class="container">
  <h1 style="margin-bottom: 30px;">üìä –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>

  <div *ngIf="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>

  <div *ngIf="!loading">
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">üìÖ</div>
        <div class="stat-value">{{ stats.totalEvents }}</div>
        <div class="stat-label">–í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">‚úÖ</div>
        <div class="stat-value">{{ stats.activeEvents }}</div>
        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">üë•</div>
        <div class="stat-value">{{ stats.totalRegistrations }}</div>
        <div class="stat-label">–í—Å–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">üí∫</div>
        <div class="stat-value">{{ stats.totalOccupied }} / {{ stats.totalCapacity }}</div>
        <div class="stat-label">–ó–∞–Ω—è—Ç–æ –º–µ—Å—Ç</div>
      </div>
    </div>

    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="card" style="margin-top: 30px;">
      <div class="card-header">
        <h2 class="card-title">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
      </div>
      <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button routerLink="/admin/events/new" class="btn btn-primary">
          ‚ûï –°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
        </button>
        <button routerLink="/events" class="btn btn-secondary">
          üìã –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
        </button>
        <button routerLink="/admin/registrations" class="btn btn-secondary">
          üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        </button>
      </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π -->
    <div class="card" style="margin-top: 30px;">
      <div class="card-header">
        <h2 class="card-title">–°–æ–±—ã—Ç–∏—è</h2>
      </div>
      
      <div *ngIf="events.length === 0" class="text-center" style="padding: 40px;">
        <h3>–ù–µ—Ç —Å–æ–±—ã—Ç–∏–π</h3>
        <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</p>
        <button routerLink="/admin/events/new" class="btn btn-primary" style="margin-top: 15px;">
          –°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
        </button>
      </div>

      <div *ngIf="events.length > 0" class="events-table">
        <table class="table">
          <thead>
            <tr>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
              <th>–î–∞—Ç–∞</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let event of events">
              <td><strong>{{ event.title }}</strong></td>
              <td>{{ formatDate(event.date) }}</td>
              <td>
                <span class="status-badge" [class]="'status-' + event.status">
                  {{ event.status }}
                </span>
              </td>
              <td>
                <div class="progress-bar">
                  <div class="progress-fill" [style.width.%]="getOccupancyRate(event)"></div>
                </div>
                <span style="font-size: 12px; color: #6c757d;">
                  {{ event.capacity - event.availableSeats }} / {{ event.capacity }} ({{ getOccupancyRate(event) }}%)
                </span>
              </td>
              <td>
                <button [routerLink]="['/events', event._id]" class="btn btn-sm btn-secondary">
                  üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div class="card" style="margin-top: 30px;">
      <div class="card-header">
        <h2 class="card-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</h2>
      </div>
      
      <div *ngIf="recentRegistrations.length === 0" class="text-center" style="padding: 20px;">
        <p>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
      </div>

      <div *ngIf="recentRegistrations.length > 0">
        <table class="table">
          <thead>
            <tr>
              <th>–£—á–∞—Å—Ç–Ω–∏–∫</th>
              <th>Email</th>
              <th>–°–æ–±—ã—Ç–∏–µ</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–î–∞—Ç–∞</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let reg of recentRegistrations">
              <td>{{ reg.participant.firstName }} {{ reg.participant.lastName }}</td>
              <td>{{ reg.participant.email }}</td>
              <td>{{ getEventTitle(reg.event) }}</td>
              <td>
                <span class="status-badge" [class]="'status-' + reg.status">
                  {{ reg.status }}
                </span>
              </td>
              <td>{{ formatDate(reg.createdAt) }}</td>
            </tr>
          </tbody>
        </table>
        <div class="text-center" style="margin-top: 15px;">
          <button routerLink="/admin/registrations" class="btn btn-primary">
            –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚Üí
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
