<div class="container">
  <div class="card">
    <div class="card-header">
      <h1 class="card-title">–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —Å–æ–±—ã—Ç–∏—è</h1>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫ -->
    <div class="filters-wrapper">
      <div class="filters-grid">
        <select
          [(ngModel)]="selectedCategory"
          (change)="onFilterChange()"
          class="form-control"
        >
          <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
          <option *ngFor="let cat of categories" [value]="cat">
            {{ cat }}
          </option>
        </select>

        <select
          [(ngModel)]="selectedStatus"
          (change)="onFilterChange()"
          class="form-control"
        >
          <option value="–∞–∫—Ç–∏–≤–Ω–æ–µ">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
          <option value="–∑–∞–≤–µ—Ä—à–µ–Ω–æ">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
          <option value="–æ—Ç–º–µ–Ω–µ–Ω–æ">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
          <option value="">–í—Å–µ</option>
        </select>

        <input
          type="text"
          [(ngModel)]="searchQuery"
          (keyup.enter)="onSearch()"
          placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é..."
          class="form-control"
        />

        <button (click)="onSearch()" class="btn btn-primary search-btn">
          üîç –ü–æ–∏—Å–∫
        </button>
      </div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    <div *ngIf="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π...</div>
    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

    <!-- –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π -->
    <div class="events-grid" *ngIf="!loading && events.length > 0">
      <div
        *ngFor="let event of events"
        class="event-card"
        [routerLink]="['/events', event._id]"
      >
        <div
          class="event-image"
          [style.background-image]="getBackgroundImage(event)"
        >
          <span class="event-badge">{{ event.category }}</span>
        </div>
        <div class="event-content">
          <h3 class="event-title">{{ event.title }}</h3>
          <p class="event-date">üìÖ {{ formatDate(event.date) }}</p>
          <p class="event-location">üìç {{ event.location }}</p>
          <p class="event-description">
            {{ event.description.substring(0, 100) }}...
          </p>
          <div class="event-footer">
            <div
              class="event-seats"
              [class.seats-low]="event.availableSeats < 10"
            >
              {{ event.availableSeats }} / {{ event.capacity }}
            </div>
            <div class="event-price" *ngIf="event.price > 0">
              {{ event.price }}
            </div>
            <div class="event-price" *ngIf="event.price === 0">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
          </div>
          <button
            [routerLink]="['/events', event._id]"
            class="btn btn-primary event-detail-btn"
          >
            –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
          </button>
        </div>
      </div>
    </div>

    <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
    <div
      *ngIf="!loading && events.length === 0"
      class="text-center"
      style="padding: 40px"
    >
      <h3>–°–æ–±—ã—Ç–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
      <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>
    </div>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    <div *ngIf="totalPages > 1" class="pagination">
      <button
        (click)="previousPage()"
        [disabled]="currentPage === 1"
        class="btn btn-secondary"
      >
        ‚Üê –ù–∞–∑–∞–¥
      </button>
      <span style="margin: 0 20px">
        –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ currentPage }} –∏–∑ {{ totalPages }} (–í—Å–µ–≥–æ:
        {{ totalEvents }})
      </span>
      <button
        (click)="nextPage()"
        [disabled]="currentPage === totalPages"
        class="btn btn-secondary"
      >
        –í–ø–µ—Ä–µ–¥ ‚Üí
      </button>
    </div>
  </div>
</div>
