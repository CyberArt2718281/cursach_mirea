<div class="container">
  <div *ngIf="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <div *ngIf="event && !loading" class="event-detail-wrapper">
    <button
      (click)="router.navigate(['/events'])"
      class="btn btn-secondary back-button"
    >
      ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
    </button>

    <!-- Hero Section with Image -->
    <div class="event-hero">
      <div
        class="event-hero-image"
        [style.background-image]="
          'url(' + (event.imageUrl || 'assets/default-event.jpg') + ')'
        "
      >
        <div class="hero-overlay">
          <div class="hero-badges">
            <span class="event-badge">{{ event.category }}</span>
            <span class="event-status" [class]="'status-' + event.status">{{
              event.status
            }}</span>
          </div>
          <h1 class="hero-title">{{ event.title }}</h1>
        </div>
      </div>
    </div>

    <!-- Main Content Grid -->
    <div class="event-content-grid">
      <!-- Left Column: Main Info -->
      <div class="main-column">
        <!-- Key Information Card -->
        <div class="card info-card">
          <h2 class="section-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
          <div class="info-grid">
            <div class="info-item">
              <div class="info-icon">üìÖ</div>
              <div class="info-content">
                <div class="info-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</div>
                <div class="info-value">{{ formatDate(event.date) }}</div>
              </div>
            </div>
            <div class="info-item" *ngIf="event.endDate">
              <div class="info-icon">üèÅ</div>
              <div class="info-content">
                <div class="info-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</div>
                <div class="info-value">{{ formatDate(event.endDate) }}</div>
              </div>
            </div>
            <div class="info-item">
              <div class="info-icon">üìç</div>
              <div class="info-content">
                <div class="info-label">–ú–µ—Å—Ç–æ</div>
                <div class="info-value">{{ event.location }}</div>
              </div>
            </div>
            <div class="info-item">
              <div class="info-icon">üí∫</div>
              <div class="info-content">
                <div class="info-label">–ú–µ—Å—Ç–∞</div>
                <div
                  class="info-value"
                  [class.text-danger]="event.availableSeats < 10"
                >
                  {{ event.availableSeats }} –∏–∑ {{ event.capacity }}
                </div>
              </div>
            </div>
            <div class="info-item">
              <div class="info-icon">üí∞</div>
              <div class="info-content">
                <div class="info-label">–°—Ç–æ–∏–º–æ—Å—Ç—å</div>
                <div class="info-value">
                  <span *ngIf="event.price > 0">{{ event.price }} ‚ÇΩ</span>
                  <span *ngIf="event.price === 0" class="text-success"
                    >–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span
                  >
                </div>
              </div>
            </div>
            <div class="info-item" *ngIf="event.registrationDeadline">
              <div class="info-icon">‚è∞</div>
              <div class="info-content">
                <div class="info-label">–î–µ–¥–ª–∞–π–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                <div class="info-value">
                  {{ formatDate(event.registrationDeadline) }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Description Card -->
        <div class="card description-card">
          <h2 class="section-title">–û–ø–∏—Å–∞–Ω–∏–µ</h2>
          <p class="description-text">{{ event.description }}</p>
        </div>

        <!-- Tags Card -->
        <div class="card tags-card" *ngIf="event.tags && event.tags.length > 0">
          <h2 class="section-title">–¢–µ–≥–∏</h2>
          <div class="tags">
            <span *ngFor="let tag of event.tags" class="tag">{{ tag }}</span>
          </div>
        </div>

        <!-- Stats Card (for authenticated users) -->
        <div
          *ngIf="authService.isAuthenticated() && stats"
          class="card stats-card"
        >
          <h2 class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è</h2>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">üë•</div>
              <div class="stat-value">{{ stats.registeredCount }}</div>
              <div class="stat-label">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">‚úÖ</div>
              <div class="stat-value">{{ stats.confirmedCount }}</div>
              <div class="stat-label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üé´</div>
              <div class="stat-value">{{ stats.attendedCount }}</div>
              <div class="stat-label">–ü–æ—Å–µ—Ç–∏–ª–æ</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üí≥</div>
              <div class="stat-value">{{ stats.paidCount }}</div>
              <div class="stat-label">–û–ø–ª–∞—á–µ–Ω–æ</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üìä</div>
              <div class="stat-value">{{ stats.occupancyRate }}</div>
              <div class="stat-label">–ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Sidebar -->
      <div class="sidebar-column">
        <!-- Registration Card -->
        <div
          class="card registration-card"
          *ngIf="event.availableSeats > 0 && event.status === '–∞–∫—Ç–∏–≤–Ω–æ–µ'"
        >
          <div class="registration-content">
            <div class="registration-price">
              <span class="price-label">–°—Ç–æ–∏–º–æ—Å—Ç—å</span>
              <span class="price-value" *ngIf="event.price > 0"
                >{{ event.price }} ‚ÇΩ</span
              >
              <span class="price-value free" *ngIf="event.price === 0"
                >–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span
              >
            </div>
            <button
              [routerLink]="['/register', event._id]"
              class="btn btn-register"
            >
              ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
            </button>
            <div class="seats-info">
              <span class="seats-icon">üí∫</span>
              <span
                class="seats-text"
                [class.seats-low]="event.availableSeats < 10"
              >
                –û—Å—Ç–∞–ª–æ—Å—å {{ event.availableSeats }} –º–µ—Å—Ç
              </span>
            </div>
          </div>
        </div>

        <!-- Sold Out Card -->
        <div class="card sold-out-card" *ngIf="event.availableSeats === 0">
          <div class="sold-out-content">
            <div class="sold-out-icon">üé´</div>
            <h3>–í—Å–µ –º–µ—Å—Ç–∞ –∑–∞–Ω—è—Ç—ã</h3>
            <p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –∑–∞–∫—Ä—ã—Ç–∞</p>
          </div>
        </div>

        <!-- Organizer Card -->
        <div class="card organizer-card">
          <h3 class="organizer-title">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</h3>
          <div class="organizer-content">
            <div class="organizer-item">
              <span class="organizer-icon">üë§</span>
              <div class="organizer-info">
                <div class="organizer-label">–ò–º—è</div>
                <div class="organizer-value">{{ event.organizer.name }}</div>
              </div>
            </div>
            <div class="organizer-item">
              <span class="organizer-icon">üìß</span>
              <div class="organizer-info">
                <div class="organizer-label">Email</div>
                <div class="organizer-value">
                  <a href="mailto:{{ event.organizer.email }}">{{
                    event.organizer.email
                  }}</a>
                </div>
              </div>
            </div>
            <div class="organizer-item" *ngIf="event.organizer.phone">
              <span class="organizer-icon">üìû</span>
              <div class="organizer-info">
                <div class="organizer-label">–¢–µ–ª–µ—Ñ–æ–Ω</div>
                <div class="organizer-value">{{ event.organizer.phone }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Admin Actions Card -->
        <div *ngIf="authService.isAdmin()" class="card admin-card">
          <h3 class="admin-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
          <div class="admin-actions">
            <button
              [routerLink]="['/admin/events/edit', event._id]"
              class="btn btn-edit"
            >
              ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
            </button>
            <button (click)="deleteEvent()" class="btn btn-delete">
              üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
